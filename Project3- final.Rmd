---
title: "Finding stations that accomodates suitable weather conditions and the salinity levels to support the presence of Trichodesmium"

author: "500594412"
subtitle: "Project 3"
date: "University of Sydney | DATA1001 | November 2020"
output:
  html_document:
    fig_caption: yes
    number_sections: yes
    self_contained: yes
    theme: flatly
    toc: true
    toc_depth: 3
    toc_float: true
    code_folding: hide
---

<br>

![](https://cff2.earth.com/uploads/2019/09/15190611/capricorn_oli_2019244_lrg-1400x850.jpg)

# Recommendation

* Clients:

  + Great Barrier Reef Marine Park Authority(GBRMPA)
  
  + Australian Maritime Safety Authority(AMSA).
  

* Recommendation: 

  + Increase government funding to:

    - regulate and monitor physio-chemical parameters like salinity levels and water quality in months between *March-May* and *October* to develop Trichodesmium cultures in the following 4 stations:
 
      1. **John Brewer Reef**

      2. **Townsville Shipping Channel**

      3. **Woongarra Burkitts Reef**

      4. **QSS1**
      
    - Encourage research expeditions about the phenomena as:
    
      * Trichodesmium is an important link in the global Nitrogen cycle, due to its significant input of atmospheric nitrogen into the ocean. 

  + Control and minimize tourist activity and tours from those above mentioned stations for preservation.


<br>

# Evidence

Data was obtained from ['AIMS'](https://researchdata.edu.au/great-barrier-reef-1992-2009/677311) (Australian Institute of Marine Science).


A study by **Raji and Padmavati, 2017** showed that `" temperature and salinity were the primary agents triggering occurrence of algal bloom (T. erythraeum)"`

Thus, this report explored three variables (Temperature, season and salinity level) while highlighting potential marine Stations that could support and preserve the Trichodesmium blooms.


```{r, warning=FALSE, include=FALSE, echo=FALSE}

# attaching all relevant libraries

library(multicon)
library(foreign)
library(lubridate)
library(dplyr)
library(ggplot2)
library(paletteer)
library(tidyverse)
library(hrbrthemes)
library(viridis)
library(data.table)
library(MASS)
library(forcats)


# Read in your data

## Option 3: Great Barrier Reef Chlorophyll Monitoring
gbr = read.csv("http://www.maths.usyd.edu.au/u/UG/JM/DATA1001/r/current/projects/2020data/GBR.csv")

```

<br>

## Data wrangling

Steps taken while cleaning the data set:

* All objects with empty or 'NA' cells in a column were removed

* A new data table was made called as 'gbr_new' consisting of the following variables used in the report: 'STATION_NAME', 'SAMPLE_TIME', 'TEMPERATURE', 'SALINITY' and 'TRICHODESMIUM'

* Variable 'SAMPLE_TIME' was converted to 'month'



```{r,warning=FALSE }

# removing the NAs
gbr <- gbr[!is.na(gbr$SECCHI_DEPTH),]
gbr <- gbr[!is.na(gbr$ACOUSTIC_DEPTH),]
gbr <- gbr[!is.na(gbr$TEMPERATURE),]
gbr <- gbr[!is.na(gbr$SALINITY),]
gbr <- gbr[!is.na(gbr$SAMPLE_DEPTH),]
gbr <- gbr[!is.na(gbr$LATITUDE),]
gbr <- gbr[!is.na(gbr$LONGITUDE),]
gbr <- gbr[!is.na(gbr$CHL_A),]

#Converting SAMPLE_TIME to month

gbr$month_gbr <- format(as.Date(gbr$SAMPLE_TIME), "%b")

#removing the variables which are going to be used in the report

gbr_new = subset(gbr, select = -c(ACOUSTIC_DEPTH,SECCHI_DEPTH,LONGITUDE, LATITUDE, STATION_ID, TRANSECT, REPLICATE_DESC, SAMPLE_DEPTH, SAMPLE_TIME, CHL_A ) )

```

Final data set:

```{r}
str(gbr_new)

```

## Optimal weather conditions for trichodesmium blooming

### Month

```{r, warning=FALSE, message=FALSE}

#filtering out trichodesmium = "Present"
copy_gbr <- gbr_new

copy_gbr = copy_gbr%>% filter(TRICHODESMIUM == "Present") 

#creating data.frame

month<- copy_gbr$month_gbr
presence<-copy_gbr$TRICHODESMIUM

df2<-data.frame(month,presence)

df2<-as.data.table(df2)

#adding in freqeuncies

df2.freq = table(df2)

#plotting
df2 %>% 
  
  ggplot(aes(x = month, fill = presence)) + geom_bar(color = "black", position = "dodge") +
theme(axis.text.x=element_text(angle=90))+ theme_ipsum() + scale_fill_manual(values = c("skyblue4")) + ggtitle("Months supporting Trichodesmium bloom") 


```

Insights from graph:

1. Few stations in March, May and October have Trichodesmium present

2. Since, these months don't fall under the same seasonal bands:

  + March ~ Summer
  + May ~ Autumn
  + October ~ spring

It suggests that besides season, probably temperatures are at play.


### Temperature

```{r, message=FALSE, warning=FALSE}


#fill <- "#c8a2c8"
line <- "#000000"


p10 <- ggplot(gbr_new, aes(x = TRICHODESMIUM, y = TEMPERATURE, fill = TRICHODESMIUM)) +
        geom_boxplot()

p10 <- p10 + scale_x_discrete(name = "Trichodesmium") +
  
        geom_boxplot( colour = line,  outlier.colour = "#FF0000", outlier.shape = 24)+
  
  theme(legend.position="none")+
  
  scale_fill_brewer(palette="BuPu") + 
    scale_y_continuous(name = "Temperature") +  scale_y_continuous(limits = c(23, 30), breaks = seq(23, 30, by = 2))+
  
  ggtitle("Temperatures vs Trichodesmium presence")+
  geom_jitter(color="black", size=0.9, alpha=0.9) +
    theme(
      legend.position="none",
      plot.title = element_text(size=17)
    ) 

p10


```

Insights from box plot:

1. Temperatures for when Trichodesmium is *absent* overlaps for when it is *present*

2. However, Trichodesmium seems to occur in specific conditions for when temperature is betwwen  \approx $25^{\circ}C$ and \approx $29^{\circ}C$

3. It can be assumed that Trichodesmium can be present for Temperature greater than $29^{\circ}C$ too, till an extend.


## Optimal salinity level for trichodesmium blooming

### Hypothesis testing: T-test


Past research papers (**like Fu and Bell, 2020** and **Blondeau-Patissier, Ernesto Brando, LÃ¸nborg and M. Leahy, 2018** amongst many others) reported an average salinity between 33-37psu (average: 35psu) that supports Trichodesmium bloom.

Since we do not have a literature value for population standard deviation and are comparing values in regards of mean, we use a *T-test* to see if the sample data set supports the literature salinity values.

**HYPOTHESIS**

Two-tailed hypothesis:

$H_0$: Trichodesmium is present in an average salinity $=$ 35psu

$H_1$: Trichodesmium is present in an average salinity $\neq$ 35psu 


**ASSUMPTIONS**

1. Each salinity value in the sample had an equal likelyhood of being chosen and were independent of each other

2. Salinity data follows a normal model

**TEST STATISTIC**

\begin{equation}
\ TS = \frac{(OM - EM)\times{\sqrt n}}{SD_{sample}}
\end{equation}

Where, OM = observed mean, EM = expected mean and $n$ = sample size

* EM is the literature value i.e. 35 psu

* OM is average salinity when Trichodesmium is present in the data set

* $SD_{sample}$ is found by `sd(gbr_new$SALINITY)`

* $n$ = 24


Calculation summary:

```{r, warning=FALSE, message=FALSE}
library(formattable)

#new data frame only with salinities where Tricho is present
Tricho_present <-(gbr_new$SALINITY[gbr_new$TRICHODESMIUM=="Present"])

mean_s<-mean(Tricho_present)
sd_s<-sd(Tricho_present)


Values<- c(35, mean_s, sd_s )
Aspect<-c("Expected Mean", "Observed Mean", "Sample standard deviation")


df2<-data.frame(Aspect,Values)

formattable(df2, 
            align = c("l",rep("r", NCOL(df2) - 1)),
            list(Aspect = formatter("span", style = ~ style(color = "grey", font.weight = "bold")), area(col = 2) ~ color_tile("mistyrose1","lightpink1")))

```


Test statistic:

```{r, comment=""}

a<-(mean_s - 35)*sqrt(length(Tricho_present))/sd_s
cat("Test Statistic:", a)

```

**P-VALUE**

One sample t-test:

```{r, comment=""}

t.test(Tricho_present, mu = 35)


```


**CONCLUSION**

Since 35 does not fall inside the confidence interval (and p < 0.05), we *reject* the null hypothesis.

The difference of 1.5psu between the literature mean and our observed mean, could be due to environmental factors.

<br>


**CHECKING ASSUMPTIONS**

1. *Independency*

One salinity value does not affect the value of second salinity value; they are unrelated and each have an equal likelyhood of occurance.

2. *Test for normality: QQ Plot*
```{r}

SALINITY <- gbr_new$SALINITY



ggplot(gbr_new, aes(sample = SALINITY)) +  
     stat_qq(aes(color = SALINITY)) + stat_qq_line() + ggtitle("QQplot") + scale_color_manual(values = c("#00AFBB", "#E7B800"))


```

A quantile-quantile (Q-Q) plot shows:

* Observations lies approximately on a straight line; uneven scattering towards of the line could be due to possible outliers.

* Strong support for normality

<br>


## Stations meeting all conditions (Salinity level, Temperature and season)

Salinity range:

```{r, echo=FALSE, comment= ""}
a<-min(gbr_new$SALINITY[gbr_new$TRICHODESMIUM == "Present"])
b<-max(gbr_new$SALINITY[gbr_new$TRICHODESMIUM == "Present"])

cat("Minimum salinity level supporting Trichodesmium presence: ", a, "psu")
cat("\n")
cat("Maximum salinity level supporting Trichodesmium presence: ", b, "psu")

```


Filtering stations according based on following criteria:

* Temperature >= 25

* Salinity between 35psu and 38psu 

* Samples were taken out in either March, May or October



```{r, echo=FALSE}

library(tidyverse)
library(formattable)
library(RColorBrewer)
library(tidyverse)

  Filtered_stations <- subset(gbr_new, TEMPERATURE >= 25 & SALINITY >= 35.6 & ( month_gbr == "May" | month_gbr == "Mar" | month_gbr == "Oct"))


Trichodesmium<- Filtered_stations$TRICHODESMIUM
Stations<- Filtered_stations$STATION_NAME
Month <- Filtered_stations$month_gbr

df2<-data.frame(Stations,Trichodesmium, Month)


formattable(df2, align = c("l",rep("r", NCOL(df2) - 1)), 
            
              list(Trichodesmium = formatter("span", style = x ~ style(color = ifelse(Trichodesmium == "Present", "green", 
    ifelse(Trichodesmium == "Absent", "red", "orange"))))))


```

Four stations with supportive evidence for bloom:

1. **John Brewer Reef**

2. **Townsville Shipping Channel**

3. **Woongarra Burkitts Reef**

4. **QSS1**

## Limitations

* Data from each station in the data set was taken in a different year ranging from 1992 to 2009; multiple changes could have occurred between years, making it tougher to find association between variables.


* Exact conditions for the rare trichodesmium bloom is much more specific than just 3 variables

* The data set includes multiple empty cells which had to be removed to prevent result manipulation; alternatively, that decreases our validity and affects the spread


* Temperature is an ever-changing constant, with vast ranges in each day; therefore, the temperature recorded in the dataset were relative to a particular moment, not averaged to the whole day or week.



# Other Evidence 

* Study done by **Breitbarth, Oschlies and Laroche, 2007**, and **Zhou and Jiang, 2020** quotes:

  "`Trichodesmium could acclimate and grow at temperatures ranging from 20 to 34Â°C"` and `"Trichodesmium has optimal growth at temperatures ranging from 24Â°C to 30Â°C"` respectively

  + This is supported by our data set, as we get Trichodesmium being present in:
  
     - Temperatures greater than $25 ^{\circ} C$ 
     - To an extent, possibly till $32 ^ {\circ} C$ 
     
<br>

* Study done by **Fu and Bell, 2020** and **Blondeau-Patissier, Ernesto Brando, LÃ¸nborg and M. Leahy, 2018** quotes:

  `"Maximum growth occurred with salinities in the range 32 to 37 psu"` and `"maximum growth for Trichodesmium occur at salinities of 33â37 psu"` respectively

  + This too is supported by our data set, as we get average salinities for Trichodesmium being present as:
  
    - Average salinity: 36.5 psu
    - Range of salinity: 35 - 38 psu
    

# Data science reflection

One of my greatest skills is to be able to convert a mess into a body of structured organization. Thus, when DATA1001 provided me with tools exactly for that, possibilities were endless. 

It developed my statistical thinking during analysis, allowed me to visualize and reproduce thoughts clearly, and made me seek connections with other similar works. I have no doubt that I will remember, carry and build on these skills as my major in computational data science in the future.

# Acknowledgements

* Ed posts:
  + [Help](https://edstem.org/courses/4447/discussion/353453) with barplot re-arrangment 
  
  + [Help](https://edstem.org/courses/4447/discussion/353173) with formattable table 
  
* Stack Overflow:

  + [Help](https://stackoverflow.com/questions/16147915/how-to-convert-continuous-variable-to-discrete-in-r) with continuous to discrete conversion
  
  + [Help](https://stackoverflow.com/questions/15589601/print-string-and-variable-contents-on-the-same-line-in-r) with printing strings
  
  + [Help](https://stackoverflow.com/questions/56777251/how-to-conditionally-color-table-elements-using-formattable-and-color-tile) with conditionally formatting formattable table
  
  + [Help](https://stackoverflow.com/questions/49084904/r-markdown-bullet-list-with-multiple-levels) with different bullet-list levelling
  
  + [Help](https://stackoverflow.com/questions/5831794/opposite-of-in-exclude-rows-with-values-specified-in-a-vector) with filtering and excluding rows
 

# References

1. Fu, F. and Bell, P., 2020. Effect Of Salinity On Growth, Pigmentation, N2 Fixation And Alkaline Phosphatase Activity Of Cultured Trichodesmium Sp.. [ebook] Queensland: MARINE ECOLOGY PROGRESS SERIES, p.69. Available at: <https://pdfs.semanticscholar.org/1a87/79cadf273d688beb46683ec58e6a8075f186.pdf> [Accessed 15 November 2020].


2. Blondeau-Patissier, D., Ernesto Brando, V., LÃ¸nborg, C. and M. Leahy, S., 2018. Phenology Of Trichodesmium Spp. Blooms In The Great Barrier Reef Lagoon, Australia, From The ESA-MERIS 10-Year Mission. [ebook] journal.plos. Available at: <https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0208010> [Accessed 15 November 2020].


3. J. R. Uwins, P., Elmetri, I. and A. Phillips, J., 2005. Laboratory Culture Studies Of Trichodesmium Isolated From The Great Barrier Reef Lagoon, Australia. [ebook] Hydrobiologia, pp.9-21. Available at: <https://link.springer.com/article/10.1007/s10750-004-8768-1#citeas> [Accessed 15 November 2020].

4. Breitbarth, E., Oschlies, A. and Laroche, J., 2007. Physiological Constraints On The Global Distribution Of Trichodesmium - Effect Of Temperature On Diazotrophy. [online] ResearchGate. Available at: <https://www.researchgate.net/publication/29631207_Physiological_constraints_on_the_global_distribution_of_Trichodesmium_-_Effect_of_temperature_on_diazotrophy> [Accessed 19 November 2020].

5. Shetye, S., Sudhakar, M., Jena, B. and Mohan, R., 2020. Occurrence Of Nitrogen Fixing Cyanobacterium Trichodesmium Under Elevated Pco2 Conditions In The Western Bay Of Bengal. [online] Downloads.hindawi.com. Available at: <http://downloads.hindawi.com/archive/2013/350465.pdf> [Accessed 19 November 2020].

6. Zhou, F. and Jiang, Z., 2020. Summer distribution patterns of Trichodesmium spp. in the Changjiang (Yangtze River) Estuary and adjacent East China Sea shelf. Oceanologia, [online] 59(3), pp.248-261. Available at: <https://www.sciencedirect.com/science/article/pii/S0078323417300192#:~:text=Our%20study%20found%20that%20Trichodesmium,4).> [Accessed 19 November 2020].

7. Raji, K. and Padmavati, G., 2020. Temperature And Salinity Are The Probable Causative Agent For The Trichodesmium Erythraeum (Cyanophyceae) Algal Bloom On The Burmanallah Coastal Waters Of South Andaman Island. [online] Researchgate.net. Available at: <https://www.researchgate.net/publication/332877224_Temperature_and_Salinity_Are_the_Probable_Causative_Agent_for_the_Trichodesmium_erythraeum_Cyanophyceae_Algal_Bloom_on_the_Burmanallah_Coastal_Waters_of_South_Andaman_Island> [Accessed 19 November 2020].



